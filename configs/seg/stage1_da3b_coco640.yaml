trainer:
  logger:
    class_path: lightning.pytorch.loggers.WandbLogger
    init_args:
      project: da3_seg_coco
      name: stage1_da3b_coco640
  devices: 8
  accelerator: gpu
  strategy: ddp
  precision: 16-mixed

model:
  img_size: [640, 640]
  num_classes: 133
  stuff_classes: []
  attn_mask_annealing_enabled: true
  num_masked_layers: 4
  lr: 0.0002
  llrd: 0.8
  weight_decay: 0.05
  warmup_steps: [500, 1000]
  poly_power: 0.9
  network:
    class_path: depth_anything_3.model.da3_eomt_tslora.build_da3_eomt_network_from_config
    init_args:
      cfg:
        # Basic scaffold settings; override via CLI flags if running a custom encoder.
        embed_dim: 768
        num_seg_queries: 128
        num_blocks: 4
        masked_attn_enabled: true
        num_classes: ${model.num_classes}

data:
  root: /home/jovyan/ybai_ws/dataset/dataset/coco
  panoptic_json_train: /home/jovyan/ybai_ws/dataset/dataset/coco/panoptic_train2017.json
  panoptic_json_val: /home/jovyan/ybai_ws/dataset/dataset/coco/panoptic_val2017.json
  stuff_classes: []
  batch_size_per_gpu: 4
  num_workers: 8
  img_size: [640, 640]
